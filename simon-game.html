<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Simon Oyunu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .button-glow {
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            transform: scale(1.1);
        }
        
        .game-button {
            transition: all 0.2s ease;
        }
        
        .game-button:hover {
            transform: scale(1.05);
        }
        
        /* Prevent double-tap zoom on mobile/tablet */
        * {
            touch-action: manipulation;
        }
        
        body {
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
        
        .seven-segment {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            background: #000;
            color: #00ff00;
            padding: 10px 20px;
            border-radius: 8px;
            border: 2px solid #333;
            text-align: center;
            min-width: 80px;
            font-size: 2rem;
        }

        .difficulty-btn {
            transition: all 0.3s ease;
        }

        .difficulty-btn.active {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
        }

        .leaderboard-modal {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .leaderboard-entry {
            transition: all 0.3s ease;
        }

        .leaderboard-entry:hover {
            background-color: rgba(59, 130, 246, 0.1);
            transform: scale(1.02);
        }

        .trophy {
            font-size: 1.5rem;
        }
    </style>
</head>
<body class="bg-gray-900 min-h-screen flex items-center justify-center">
    <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl">
        <h1 class="text-4xl font-bold text-white text-center mb-8">Simon Oyunu</h1>
        
        <!-- Difficulty Selection -->
        <div class="mb-6">
            <h3 class="text-white text-center mb-4 font-semibold">Zorluk Seviyesi</h3>
            <div class="flex justify-center gap-3">
                <button id="easyBtn" class="difficulty-btn px-4 py-2 bg-green-600 hover:bg-green-500 text-white text-sm font-bold rounded-lg transition-all active" data-difficulty="easy">
                    üü¢ Kolay
                </button>
                <button id="mediumBtn" class="difficulty-btn px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-white text-sm font-bold rounded-lg transition-all" data-difficulty="medium">
                    üü° Orta
                </button>
                <button id="hardBtn" class="difficulty-btn px-4 py-2 bg-red-600 hover:bg-red-500 text-white text-sm font-bold rounded-lg transition-all" data-difficulty="hard">
                    üî¥ Zor
                </button>
                <button id="expertBtn" class="difficulty-btn px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white text-sm font-bold rounded-lg transition-all" data-difficulty="expert">
                    üü£ Uzman
                </button>
            </div>
        </div>

        <!-- Score Display -->
        <div class="flex justify-center mb-8">
            <div class="seven-segment" id="scoreDisplay">00</div>
        </div>
        
        <!-- Game Buttons -->
        <div class="grid grid-cols-2 gap-4 mb-8">
            <!-- Green Button (Top Left) -->
            <button id="button-0" class="game-button w-32 h-32 bg-green-600 hover:bg-green-500 rounded-lg border-4 border-green-800 active:bg-green-400" data-index="0"></button>
            
            <!-- Red Button (Top Right) -->
            <button id="button-1" class="game-button w-32 h-32 bg-red-600 hover:bg-red-500 rounded-lg border-4 border-red-800 active:bg-red-400" data-index="1"></button>
            
            <!-- Yellow Button (Bottom Left) -->
            <button id="button-2" class="game-button w-32 h-32 bg-yellow-500 hover:bg-yellow-400 rounded-lg border-4 border-yellow-700 active:bg-yellow-300" data-index="2"></button>
            
            <!-- Blue Button (Bottom Right) -->
            <button id="button-3" class="game-button w-32 h-32 bg-blue-600 hover:bg-blue-500 rounded-lg border-4 border-blue-800 active:bg-blue-400" data-index="3"></button>
        </div>
        
        <!-- Control Buttons -->
        <div class="flex justify-center gap-4 mb-4">
            <button id="startBtn" class="px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-colors">
                Oyunu Ba≈ülat
            </button>
            <button id="resetBtn" class="px-6 py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-lg transition-colors">
                Sƒ±fƒ±rla
            </button>
        </div>

        <!-- Leaderboard Button -->
        <div class="flex justify-center">
            <button id="leaderboardBtn" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-colors text-sm">
                üèÜ Liderlik Tablosu
            </button>
        </div>
        
        <!-- Game Status -->
        <div id="gameStatus" class="text-center mt-4 text-white font-semibold"></div>
    </div>

    <!-- Leaderboard Modal -->
    <div id="leaderboardModal" class="leaderboard-modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">üèÜ Liderlik Tablosu</h2>
                <button id="closeLeaderboardBtn" class="text-white hover:text-gray-300 text-2xl font-bold">√ó</button>
            </div>
            
            <div id="leaderboardContent" class="space-y-2 mb-6">
                <!-- Leaderboard entries will be populated here -->
            </div>
            
            <div class="flex justify-center">
                <button id="clearLeaderboardBtn" class="px-4 py-2 bg-red-600 hover:bg-red-500 text-white font-bold rounded-lg transition-colors text-sm">
                    Tabloyu Temizle
                </button>
            </div>
        </div>
    </div>

    <!-- New High Score Modal -->
    <div id="highScoreModal" class="leaderboard-modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl max-w-md w-full mx-4">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-yellow-400 mb-4">üéâ Yeni Rekor!</h2>
                <p class="text-white text-lg mb-4">Tebrikler! Yeni bir rekor kƒ±rdƒ±nƒ±z!</p>
                <p class="text-2xl font-bold text-green-400 mb-6" id="newScoreText">Skorunuz: 0</p>
                
                <div class="mb-6">
                    <label class="block text-white text-sm font-bold mb-2" for="playerName">
                        ƒ∞sminizi girin:
                    </label>
                    <input type="text" id="playerName" maxlength="15" 
                           class="w-full px-3 py-2 bg-gray-700 text-white border border-gray-600 rounded-lg focus:outline-none focus:border-blue-500" 
                           placeholder="Oyuncu adƒ±">
                </div>
                
                <div class="flex justify-center gap-4">
                    <button id="saveScoreBtn" class="px-6 py-2 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-colors">
                        Kaydet
                    </button>
                    <button id="skipScoreBtn" class="px-6 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded-lg transition-colors">
                        Ge√ß
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        class SimonGame {
            constructor() {
                this.MAX_GAME_LENGTH = 100;
                this.gameSequence = [];
                this.gameIndex = 0;
                this.userIndex = 0;
                this.isPlaying = false;
                this.isUserTurn = false;
                this.isGameActive = false;
                
                // Difficulty settings
                this.currentDifficulty = 'easy';
                this.difficultySettings = {
                    easy: {
                        sequenceDelay: 800,
                        buttonDelay: 50,
                        toneLength: 400,
                        name: 'Kolay'
                    },
                    medium: {
                        sequenceDelay: 600,
                        buttonDelay: 30,
                        toneLength: 300,
                        name: 'Orta'
                    },
                    hard: {
                        sequenceDelay: 400,
                        buttonDelay: 20,
                        toneLength: 200,
                        name: 'Zor'
                    },
                    expert: {
                        sequenceDelay: 250,
                        buttonDelay: 10,
                        toneLength: 150,
                        name: 'Uzman'
                    }
                };
                
                // Audio context for tones
                this.audioContext = null;
                this.gameTones = [196, 262, 330, 392]; // G3, C4, E4, G5 frequencies
                
                this.initializeElements();
                this.setupEventListeners();
            }
            
            initializeElements() {
                this.scoreDisplay = document.getElementById('scoreDisplay');
                this.gameStatus = document.getElementById('gameStatus');
                this.startBtn = document.getElementById('startBtn');
                this.resetBtn = document.getElementById('resetBtn');
                this.buttons = [];
                
                // Difficulty buttons
                this.difficultyBtns = {
                    easy: document.getElementById('easyBtn'),
                    medium: document.getElementById('mediumBtn'),
                    hard: document.getElementById('hardBtn'),
                    expert: document.getElementById('expertBtn')
                };

                // Leaderboard elements
                this.leaderboardBtn = document.getElementById('leaderboardBtn');
                this.leaderboardModal = document.getElementById('leaderboardModal');
                this.leaderboardContent = document.getElementById('leaderboardContent');
                this.closeLeaderboardBtn = document.getElementById('closeLeaderboardBtn');
                this.clearLeaderboardBtn = document.getElementById('clearLeaderboardBtn');
                
                // High score modal elements
                this.highScoreModal = document.getElementById('highScoreModal');
                this.newScoreText = document.getElementById('newScoreText');
                this.playerNameInput = document.getElementById('playerName');
                this.saveScoreBtn = document.getElementById('saveScoreBtn');
                this.skipScoreBtn = document.getElementById('skipScoreBtn');
                
                for (let i = 0; i < 4; i++) {
                    this.buttons.push(document.getElementById(`button-${i}`));
                }
            }
            
            setupEventListeners() {
                this.startBtn.addEventListener('click', () => this.startGame());
                this.resetBtn.addEventListener('click', () => this.resetGame());
                
                // Difficulty button listeners
                Object.keys(this.difficultyBtns).forEach(difficulty => {
                    this.difficultyBtns[difficulty].addEventListener('click', () => {
                        this.setDifficulty(difficulty);
                    });
                });

                // Leaderboard listeners
                this.leaderboardBtn.addEventListener('click', () => this.showLeaderboard());
                this.closeLeaderboardBtn.addEventListener('click', () => this.hideLeaderboard());
                this.clearLeaderboardBtn.addEventListener('click', () => this.clearLeaderboard());
                
                // High score modal listeners
                this.saveScoreBtn.addEventListener('click', () => this.saveHighScore());
                this.skipScoreBtn.addEventListener('click', () => this.skipHighScore());
                this.playerNameInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.saveHighScore();
                    }
                });

                // Close modals when clicking outside
                this.leaderboardModal.addEventListener('click', (e) => {
                    if (e.target === this.leaderboardModal) {
                        this.hideLeaderboard();
                    }
                });
                
                this.buttons.forEach((button, index) => {
                    button.addEventListener('click', () => this.handleButtonClick(index));
                    
                    // Prevent double-tap zoom on buttons
                    button.addEventListener('touchend', (e) => {
                        e.preventDefault();
                        this.handleButtonClick(index);
                    });
                });
                
                // Initialize audio context on first user interaction
                document.addEventListener('click', () => {
                    if (!this.audioContext) {
                        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    }
                }, { once: true });
            }

            setDifficulty(difficulty) {
                if (this.isGameActive) return; // Can't change difficulty during game
                
                this.currentDifficulty = difficulty;
                
                // Update button visual states
                Object.keys(this.difficultyBtns).forEach(diff => {
                    this.difficultyBtns[diff].classList.remove('active');
                });
                this.difficultyBtns[difficulty].classList.add('active');
                
                // Update game status
                this.gameStatus.textContent = `Zorluk: ${this.difficultySettings[difficulty].name}`;
            }
            
            startGame() {
                this.isGameActive = true;
                this.gameSequence = [];
                this.gameIndex = 0;
                this.updateScore();
                this.gameStatus.textContent = `Oyun ba≈ülƒ±yor... (${this.difficultySettings[this.currentDifficulty].name})`;
                this.startBtn.disabled = true;
                
                // Disable difficulty buttons during game
                Object.values(this.difficultyBtns).forEach(btn => {
                    btn.disabled = true;
                    btn.classList.add('opacity-50', 'cursor-not-allowed');
                });
                
                setTimeout(() => {
                    this.nextLevel();
                }, 1000);
            }
            
            resetGame() {
                this.isGameActive = false;
                this.isPlaying = false;
                this.isUserTurn = false;
                this.gameSequence = [];
                this.gameIndex = 0;
                this.userIndex = 0;
                this.updateScore();
                this.gameStatus.textContent = `Zorluk: ${this.difficultySettings[this.currentDifficulty].name}`;
                this.startBtn.disabled = false;
                this.enableButtons();
                
                // Re-enable difficulty buttons
                Object.values(this.difficultyBtns).forEach(btn => {
                    btn.disabled = false;
                    btn.classList.remove('opacity-50', 'cursor-not-allowed');
                });
            }
            
            nextLevel() {
                if (this.gameIndex >= this.MAX_GAME_LENGTH) {
                    this.gameIndex = this.MAX_GAME_LENGTH - 1;
                    return;
                }
                
                // Add random color to sequence
                this.gameSequence[this.gameIndex] = Math.floor(Math.random() * 4);
                this.gameIndex++;
                this.updateScore();
                
                this.gameStatus.textContent = 'Sekansƒ± izleyin...';
                this.disableButtons();
                
                setTimeout(() => {
                    this.playSequence();
                }, 500);
            }
            
            async playSequence() {
                this.isPlaying = true;
                const settings = this.difficultySettings[this.currentDifficulty];
                
                for (let i = 0; i < this.gameIndex; i++) {
                    const buttonIndex = this.gameSequence[i];
                    await this.lightButtonAndPlayTone(buttonIndex);
                    await this.delay(settings.buttonDelay);
                }
                
                this.isPlaying = false;
                this.isUserTurn = true;
                this.userIndex = 0;
                this.gameStatus.textContent = 'Sƒ±ranƒ±z! Sekansƒ± tekrarlayƒ±n...';
                this.enableButtons();
            }
            
            async lightButtonAndPlayTone(buttonIndex) {
                const button = this.buttons[buttonIndex];
                const settings = this.difficultySettings[this.currentDifficulty];
                
                // Light up button
                button.classList.add('button-glow');
                
                // Play tone
                this.playTone(this.gameTones[buttonIndex], settings.toneLength);
                
                await this.delay(settings.toneLength);
                
                // Turn off button
                button.classList.remove('button-glow');
            }
            
            handleButtonClick(buttonIndex) {
                if (!this.isUserTurn || this.isPlaying || !this.isGameActive) {
                    return;
                }
                
                // Light up and play tone for user click
                this.lightButtonAndPlayTone(buttonIndex);
                
                // Check if correct
                if (this.gameSequence[this.userIndex] !== buttonIndex) {
                    this.gameOver();
                    return;
                }
                
                this.userIndex++;
                
                // Check if user completed the sequence
                if (this.userIndex >= this.gameIndex) {
                    this.isUserTurn = false;
                    this.disableButtons();
                    
                    if (this.gameIndex > 0) {
                        this.gameStatus.textContent = 'Doƒüru! Bir sonraki seviye...';
                        setTimeout(() => {
                            this.playLevelUpSound();
                            setTimeout(() => {
                                this.nextLevel();
                            }, 1000);
                        }, 300);
                    }
                }
            }
            
            async gameOver() {
                this.isGameActive = false;
                this.isUserTurn = false;
                this.disableButtons();
                
                const finalScore = this.gameIndex - 1;
                this.gameStatus.textContent = `Oyun bitti! Skorunuz: ${finalScore} (${this.difficultySettings[this.currentDifficulty].name})`;
                
                // Play game over sound
                await this.playGameOverSound();
                
                // Show dashes on display
                this.scoreDisplay.textContent = '--';
                
                // Check if it's a high score
                if (this.isHighScore(finalScore)) {
                    setTimeout(() => {
                        this.showHighScoreModal(finalScore);
                    }, 1000);
                } else {
                    setTimeout(() => {
                        this.resetGame();
                    }, 3000);
                }
            }
            
            async playGameOverSound() {
                const notes = [311, 294, 277]; // DS5, D5, CS5
                
                for (const note of notes) {
                    this.playTone(note, 300);
                    await this.delay(300);
                }
                
                // Wah-wah effect
                for (let i = 0; i < 10; i++) {
                    for (let pitch = -10; pitch <= 10; pitch++) {
                        this.playTone(262 + pitch, 6); // C5 + pitch
                        await this.delay(6);
                    }
                }
            }
            
            async playLevelUpSound() {
                const notes = [330, 392, 659, 523, 587, 784]; // E4, G4, E5, C5, D5, G5
                
                for (const note of notes) {
                    this.playTone(note, 150);
                    await this.delay(150);
                }
            }
            
            playTone(frequency, duration) {
                if (!this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = 'square';
                
                gainNode.gain.setValueAtTime(0.1, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration / 1000);
                
                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration / 1000);
            }
            
            updateScore() {
                const score = this.gameIndex.toString().padStart(2, '0');
                this.scoreDisplay.textContent = score;
            }
            
            disableButtons() {
                this.buttons.forEach(button => {
                    button.disabled = true;
                    button.classList.add('opacity-50', 'cursor-not-allowed');
                });
            }
            
            enableButtons() {
                this.buttons.forEach(button => {
                    button.disabled = false;
                    button.classList.remove('opacity-50', 'cursor-not-allowed');
                });
            }
            
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            // Leaderboard methods
            getLeaderboard() {
                const leaderboard = localStorage.getItem('simonLeaderboard');
                return leaderboard ? JSON.parse(leaderboard) : [];
            }

            saveLeaderboard(leaderboard) {
                localStorage.setItem('simonLeaderboard', JSON.stringify(leaderboard));
            }

            isHighScore(score) {
                const leaderboard = this.getLeaderboard();
                const difficultyScores = leaderboard.filter(entry => entry.difficulty === this.currentDifficulty);
                
                // If less than 10 scores for this difficulty, it's automatically a high score
                if (difficultyScores.length < 10) {
                    return true;
                }
                
                // Check if score is higher than the lowest score
                const lowestScore = Math.min(...difficultyScores.map(entry => entry.score));
                return score > lowestScore;
            }

            showHighScoreModal(score) {
                this.newScoreText.textContent = `Skorunuz: ${score} (${this.difficultySettings[this.currentDifficulty].name})`;
                this.playerNameInput.value = '';
                this.highScoreModal.classList.remove('hidden');
                this.playerNameInput.focus();
                this.currentHighScore = score;
            }

            saveHighScore() {
                const playerName = this.playerNameInput.value.trim() || 'Anonim';
                const leaderboard = this.getLeaderboard();
                
                const newEntry = {
                    name: playerName,
                    score: this.currentHighScore,
                    difficulty: this.currentDifficulty,
                    date: new Date().toLocaleDateString('tr-TR')
                };
                
                leaderboard.push(newEntry);
                
                // Keep only top 10 scores per difficulty
                const difficultyScores = leaderboard.filter(entry => entry.difficulty === this.currentDifficulty);
                difficultyScores.sort((a, b) => b.score - a.score);
                const topDifficultyScores = difficultyScores.slice(0, 10);
                
                // Remove old scores for this difficulty and add new top scores
                const otherScores = leaderboard.filter(entry => entry.difficulty !== this.currentDifficulty);
                const updatedLeaderboard = [...otherScores, ...topDifficultyScores];
                
                this.saveLeaderboard(updatedLeaderboard);
                this.hideHighScoreModal();
                this.resetGame();
            }

            skipHighScore() {
                this.hideHighScoreModal();
                this.resetGame();
            }

            hideHighScoreModal() {
                this.highScoreModal.classList.add('hidden');
            }

            showLeaderboard() {
                this.updateLeaderboardDisplay();
                this.leaderboardModal.classList.remove('hidden');
            }

            hideLeaderboard() {
                this.leaderboardModal.classList.add('hidden');
            }

            updateLeaderboardDisplay() {
                const leaderboard = this.getLeaderboard();
                
                if (leaderboard.length === 0) {
                    this.leaderboardContent.innerHTML = '<p class="text-gray-400 text-center">Hen√ºz kayƒ±tlƒ± skor yok</p>';
                    return;
                }
                
                // Group by difficulty and sort
                const groupedScores = {};
                leaderboard.forEach(entry => {
                    if (!groupedScores[entry.difficulty]) {
                        groupedScores[entry.difficulty] = [];
                    }
                    groupedScores[entry.difficulty].push(entry);
                });
                
                // Sort each difficulty group
                Object.keys(groupedScores).forEach(difficulty => {
                    groupedScores[difficulty].sort((a, b) => b.score - a.score);
                });
                
                let html = '';
                const difficultyOrder = ['expert', 'hard', 'medium', 'easy'];
                
                difficultyOrder.forEach(difficulty => {
                    if (groupedScores[difficulty]) {
                        const difficultyName = this.difficultySettings[difficulty].name;
                        const difficultyIcon = {
                            easy: 'üü¢',
                            medium: 'üü°', 
                            hard: 'üî¥',
                            expert: 'üü£'
                        }[difficulty];
                        
                        html += `<div class="mb-4">
                            <h3 class="text-lg font-bold text-white mb-2">${difficultyIcon} ${difficultyName}</h3>`;
                        
                        groupedScores[difficulty].slice(0, 5).forEach((entry, index) => {
                            const trophy = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
                            html += `
                                <div class="leaderboard-entry bg-gray-700 rounded-lg p-3 flex justify-between items-center">
                                    <div class="flex items-center">
                                        <span class="trophy mr-2">${trophy}</span>
                                        <span class="text-white font-medium">${entry.name}</span>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-green-400 font-bold">${entry.score}</div>
                                        <div class="text-gray-400 text-xs">${entry.date}</div>
                                    </div>
                                </div>`;
                        });
                        
                        html += '</div>';
                    }
                });
                
                this.leaderboardContent.innerHTML = html;
            }

            clearLeaderboard() {
                if (confirm('Liderlik tablosunu temizlemek istediƒüinizden emin misiniz?')) {
                    localStorage.removeItem('simonLeaderboard');
                    this.updateLeaderboardDisplay();
                }
            }
        }
        
        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new SimonGame();
        });
    </script>
</body>
</html> 